{{extend 'templates/layout.html'}}


<div class='row'>
    <div id='columns-view' class='col-xs-12'>
        <div class='row-fluid'><!-- Form Search -->
            <form action='.' method='get'>
                <div class="input-group">
                    <input type="number" class="form-control" name='q' placeholder="Código Piquete">
                    <input type='hidden' name='page' value='{{=page}}'>
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="sumbit"> Buscar </button>
                        {{if page:}}
                            <a href="/?page={{=page-1}}" class='btn btn-default'>
                                <span class='glyphicon glyphicon-chevron-left'></span>
                            </a>
                        {{pass}}
                        <a href="/?page={{=page+1}}" class='btn btn-default'>
                            <span class='glyphicon glyphicon-chevron-right'></span>
                        </a>
                    </span>
                </div>
            </form>
        </div><!-- End Form Search -->

        <div class='row-fluid' style='margin-top:5px;'>
            <div class='well well-sm'>
                {{if col:}}
                    <table class='table table-condensed table-bordered'>
                        <tbody>
                            <tr>
                                <td width="10%"><strong>Nº</strong></td>
                                <td><span class='badge badge-default'>{{=col['numero']}}</span></td>
                                <td width="10%"><strong>Emplazamiento</strong></td>
                                <td>{{=col['emplazamiento']}}</td>
                            </tr>
                            <tr>
                                <td><strong>Orientación</strong></td>
                                <td>{{='ESTE/OESTE' if col['grupo'] == 'h' else 'NORTE/SUR'}}</td>
                                <td><strong>Numeración</strong></td>
                                <td>{{=col['altura']}}</td>
                            </tr>
                            <tr>
                                <td><strong>Dirección</strong></td>
                                <td colspan="3">{{=col['direccion']}}</td>
                            </tr>
                        </tbody>
                    </table>
                {{else:}}
                    <div class="alert alert-danger" role="alert">
                        <strong>Alerta!</strong>
                        No se encontraron coincidencias en {{=query}}
                    </div>
                {{pass}}
            </div>
        </div>
    </div>
</div>

<div class='row'>
    <div class='col-xs-12'>
        <div class='panel panel-default'>
            <div class='panel-heading'>
                <strong>Relevamiento</strong>
            </div>
            <div id='down' class='panel-body'>

                <form id='form-relevamiento' class='form-horizontal'>

                    <input type="hidden" class="form-control" id='relevamiento_columna' name='columna' value="{{=col['id']}}">

                    <div class="form-group">
                        <label for="relevamiento_sosten" class="col-xs-2 control-label">Elemento de Sostén</label>
                        <div class="col-xs-10">
                            <select class="form-control" id="relevamiento_sosten" name="sosten">
                                {{if relevamiento and relevamiento['sosten']:}}
                                    {{=fn_select(relevamiento.sosten, 'sosten')}}
                                {{else:}}
                                    {{=fn_select('', 'sosten')}}
                                {{pass}}
                            </select>
                        </div>
                    </div>

                    <div class='extras'>
                        <div id="columna-extra" style='display:none'>
                            <div class="well">
                                <div class="form-group">
                                    <label for="relevamiento_color" class="col-xs-2 control-label">Color</label>
                                    <div class="col-xs-10">
                                        <input type="string" class="form-control" id='relevamiento_color' name='color'>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="relevamiento_base_oxido" class="col-xs-2 control-label">Estado de base</label>
                                    <div class="col-xs-3">
                                        <span>
                                            <input type="checkbox" id="relevamiento_base_oxido" name='base_oxido'>
                                            <i>La base se encuentra oxidada?</i>
                                        </span>
                                    </div>
                                    <div class="col-xs-3">
                                        <span>
                                            <input type="checkbox" id="relevamiento_base_sello" name='base_sello'>
                                            <i>La base tiene sello?</i>
                                        </span>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="relevamiento_boca_inspeccion" class="col-xs-2 control-label">Tapa inspección</label>
                                    <div class="col-xs-3">
                                        <span>
                                            <input type="checkbox" id="relevamiento_boca_inspeccion" name='boca_inspeccion'>
                                            <i>Tiene boca de inspección?</i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="sujecion-extra" style='display:none'>
                            <div class='well'>
                                <div class="form-group">
                                    <label for="relevamiento_sujecion_brazo" class="col-xs-2 control-label">Sujeción Brazo</label>
                                    <div class="col-xs-10">
                                        <select class="form-control" id="relevamiento_sujecion_brazo" name="sujecion_brazo">
                                            {{if relevamiento and relevamiento['sujecion_brazo']:}}
                                                {{=fn_select(relevamiento.sujecion_brazo, 'estado')}}
                                            {{else:}}
                                                {{=fn_select('', 'estado')}}
                                            {{pass}}
                                        </select>
                                    </div>
                                </div>

                                <div id="madera-extra" style="display:none">
                                    <div class="form-group">
                                        <label for="relevamiento_base_madera" class="col-xs-2 control-label">Estado de base</label>
                                        <div class="col-xs-10">
                                            <select class="form-control" id="relevamiento_base_madera" name="base_madera">
                                                {{if relevamiento and relevamiento['base_madera']:}}
                                                    {{=fn_select(relevamiento.base_madera, 'estado')}}
                                                {{else:}}
                                                    {{=fn_select('', 'estado')}}
                                                {{pass}}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_acometida" class="col-xs-2 control-label">Acometida</label>
                        <div class="col-xs-10">
                            <select class="form-control" id="relevamiento_acometida" name="acometida">
                                {{if relevamiento and relevamiento['acometida']:}}
                                    {{=fn_select(relevamiento.acometida, 'acometida')}}
                                {{else:}}
                                    {{=fn_select('', 'acometida')}}
                                {{pass}}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_puesta_tierra" class="col-xs-2 control-label">Puesta a Tierra</label>
                        <div class="col-xs-10">
                            <select class="form-control" id="relevamiento_puesta_tierra" name="puesta_tierra">
                                {{if relevamiento and relevamiento['puesta_tierra']:}}
                                    {{=fn_select(relevamiento.puesta_tierra, 'pt')}}
                                {{else:}}
                                    {{=fn_select('', 'pt')}}
                                {{pass}}
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_lampara" class="col-xs-2 control-label">Lamparas</label>
                        <div class="col-xs-1">
                            <button id='add_lampara' type='button' class='btn btn-default btn-sm'>Agregar</button>
                        </div>
                        <div class='col-xs-7'>
                            <ul id='ptos-luz' class="list-inline">
                                {{if relevamiento:}}
                                    {{for lampara in relevamiento.lampara.select():}}
                                        <li><a href='#{{=lampara.id}}'><span class='glyphicon glyphicon-record'></span></a></li>
                                    {{pass}}
                                {{pass}}
                            </ul>
                            <input type='hidden' name='lamparas'>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_imagen" class="col-xs-2 control-label">Imagen</label>
                        <div class="col-xs-10">
                            <input type="file" accept="image/*" capture="camera" id="relevamiento_imagen" name='imagen'>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_observacion_sosten" class="col-xs-2 control-label">Observación Sosten</label>
                        <div class="col-xs-10">
                            <textarea type="text" class="form-control" id="relevamiento_observacion_sosten" name='observacion'> </textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="relevamiento_observacion_luminaria" class="col-xs-2 control-label">Observación Luminaria</label>
                        <div class="col-xs-10">
                            <textarea type="text" class="form-control" id="relevamiento_observacion_luminaria" name='observacion'> </textarea>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-xs-offset-2 col-xs-10">
                            <button type='submit' class='btn btn-primary btn-sm'> Guardar </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{{include 'templates/lampara-add.html'}}